<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="sitemap" href="/sitemap-index.xml"><link rel="canonical" href="https://www.greglturnquist.com/blog/how-to-create-your-own-openoffice/"><meta name="generator" content="Astro v5.7.4"><title>How to create your own OpenOffice backend w/ @asciidoctor /cc @kubern @ysb33r | Greetings, Programs!</title><!-- Google tag (gtag.js) @formatter:off --><script async src="https://www.googletagmanager.com/gtag/js?id=G-X8BZNP13K6"></script> <script>(function(){const measurementId = "G-X8BZNP13K6";

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', measurementId);
})();</script> <!-- Google tag (gtag.js) @formatter:on --><!-- Meta Pixel Code @formatter:off --><script>(function(){const pixel = "874624716839722";

    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', pixel);
    fbq('track', 'PageView');
})();</script> <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=874624716839722&ev=PageView&noscript=1"></noscript><!-- End Meta Pixel Code @formatter:on --><meta name="description" content="My work on creating an asciidoctor backend for Packt Publishing (i.e. OpenOffice) seems to have caught several people's attention. Today I s"><meta name="robots" content="index, follow"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Bruno+Ace+SC&family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://www.greglturnquist.com/blog/how-to-create-your-own-openoffice/"><meta property="og:title" content="How to create your own OpenOffice backend w/ @asciidoctor /cc @kubern @ysb33r | Greetings, Programs!"><meta property="og:description" content="My work on creating an asciidoctor backend for Packt Publishing (i.e. OpenOffice) seems to have caught several people's attention. Today I s"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://www.greglturnquist.com/blog/how-to-create-your-own-openoffice/"><meta property="twitter:title" content="How to create your own OpenOffice backend w/ @asciidoctor /cc @kubern @ysb33r | Greetings, Programs!"><meta property="twitter:description" content="My work on creating an asciidoctor backend for Packt Publishing (i.e. OpenOffice) seems to have caught several people's attention. Today I s"><link rel="stylesheet" href="/_astro/_page_.B6AHiRuu.css"></head> <body data-theme="dionysus"> <header class="fixed top-0 z-50 w-full left-0"> <div class="site-container mx-auto px-4 mt-4"> <div class="flex justify-between items-center bg-white py-4 rounded-lg px-4 border-black border"> <a href="/" class="logo uppercase font-logo transition-colors duration-200 font-light text-header-logo hover:text-primary">  <img src="/_astro/astro.Dm8K3lV8_Z1zWTOa.svg" alt width="115" height="48" loading="lazy" decoding="async" class="hidden"> <span class="font-bold">Greetings</span> Programs!
</a> <nav class="relative flex items-center gap-2 lg:gap-8" aria-label="Site Navigation"> <!-- Desktop Menu --> <ul class="hidden lg:flex lg:gap-8 items-center"> <li class="relative group"> <div class="flex items-center gap-1"> <a href="/bio" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text hover:text-nav-text-hover"> About Greg  </a> </div>  </li><li class="relative group"> <div class="flex items-center gap-1"> <a href="/books" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text hover:text-nav-text-hover"> Books  </a> </div>  </li><li class="relative group"> <div class="flex items-center gap-1"> <a href="/blog" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text-current font-semibold" aria-current="page"> Blog  </a> </div>  </li> </ul> <a href="/list" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 bg-primary text-white hover:bg-primary-light focus-visible:ring-primary hover:ring-2 hover:ring-primary hover:ring-offset-2 h-10 px-4 py-2 text-small " aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Sign Up </a> <!-- Mobile Menu Button --> <button class="mobile-menu-button relative z-30 p-2 border-none cursor-pointer bg-transparent lg:hidden" aria-label="Toggle Menu" aria-expanded="false"> <span class="menu-icon block"> <svg xmlns="http://www.w3.org/2000/svg" stroke-width="2" width="24" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none" viewBox="0 0 24 24" class="lucide lucide-menu text-body-base">  <line x1="4" x2="20" y1="12" y2="12"></line> <line x1="4" x2="20" y1="6" y2="6"></line> <line x1="4" x2="20" y1="18" y2="18"></line>  </svg> </span> <span class="close-icon hidden"> <svg xmlns="http://www.w3.org/2000/svg" stroke-width="2" width="24" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none" viewBox="0 0 24 24" class="lucide lucide-x text-white">  <path d="M18 6 6 18"></path> <path d="m6 6 12 12"></path>  </svg> </span> </button> <!-- Mobile Menu Panel --> <div class="mobile-menu fixed inset-0 z-20 px-8 pt-20 bg-primary lg:hidden hidden opacity-0 scale-95 transform transition-all duration-200 ease-out overflow-y-auto"> <ul class="flex flex-col gap-4"> <li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/bio" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text hover:text-nav-mobile-text-hover"> About Greg </a>  </div>  </div> </li><li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/books" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text hover:text-nav-mobile-text-hover"> Books </a>  </div>  </div> </li><li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/blog" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text-current font-semibold" aria-current="page"> Blog </a>  </div>  </div> </li> </ul> <!-- Updated mobile CTA button styling --> <div class="mt-8 pb-8"> <a href="/list" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 text-white ring-2 ring-white focus-visible:ring-white hover:ring-2 hover:ring-black hover:ring-offset-2 h-10 px-4 py-2 text-small " aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Sign Up </a> </div> </div> </nav> </div> </div></header> <script type="module">const v=document.querySelectorAll(".group");v.forEach(s=>{const e=s.querySelector("a"),t=s.querySelector(".submenu"),n=t?.querySelectorAll("a");t&&e&&(s.addEventListener("mouseenter",()=>{l(t,e)}),s.addEventListener("mouseleave",()=>{i(t,e)}),e.addEventListener("keydown",c=>{c.key==="ArrowDown"&&s.children&&(c.preventDefault(),l(t,e),n?.[0]?.focus())}),e.addEventListener("focus",()=>{i(t,e)}),n?.forEach((c,a)=>{c.addEventListener("keydown",d=>{const m=n.length-1;switch(d.key){case"ArrowDown":d.preventDefault(),a<m&&n[a+1].focus();break;case"ArrowUp":d.preventDefault(),a>0?n[a-1].focus():(e.focus(),i(t,e));break;case"Escape":d.preventDefault(),i(t,e),e.focus();break;case"Tab":i(t,e);break}})}),document.addEventListener("focusin",c=>{s&&!s.contains(c.target)&&i(t,e)}))});function l(s,e){s.classList.remove("invisible","opacity-0"),s.classList.add("visible","opacity-100"),e.setAttribute("aria-expanded","true")}function i(s,e){s.classList.add("invisible","opacity-0"),s.classList.remove("visible","opacity-100"),e.setAttribute("aria-expanded","false")}document.querySelectorAll(".mobile-submenu-button").forEach(s=>{s.addEventListener("click",()=>{const e=s.parentElement?.nextElementSibling,t=s.querySelector("svg");if(e){e.classList.toggle("hidden"),t?.classList.toggle("rotate-180");const n=e.classList.contains("hidden")?"false":"true";s.setAttribute("aria-expanded",n)}})});const f=document.querySelector(".mobile-menu-button"),o=document.querySelector(".mobile-menu"),r=document.querySelector(".menu-icon"),u=document.querySelector(".close-icon");f?.addEventListener("click",()=>{o?.classList.contains("hidden")?(document.body.style.overflow="hidden",o?.classList.remove("hidden"),requestAnimationFrame(()=>{o?.classList.remove("opacity-0","scale-95"),o?.classList.add("opacity-100","scale-100")}),r?.classList.add("hidden"),u?.classList.remove("hidden")):(document.body.style.overflow="",o?.classList.add("opacity-0","scale-95"),o?.classList.remove("opacity-100","scale-100"),setTimeout(()=>{o?.classList.add("hidden")},200),r?.classList.remove("hidden"),u?.classList.add("hidden"))});</script>  <div class="w-full h-120 absolute top-0 left-0 z-0 overflow-hidden border-b border-black">  </div> <article class="site-container--small mx-auto px-4 prose relative z-10 pb-base"> <div class="mt-42 mb-12 text-center"> <h1>How to create your own OpenOffice backend w/ @asciidoctor /cc @kubern @ysb33r</h1> <div class="flex items-center justify-center gap-4 text-gray-600"> <time datetime="2015-02-24T09:51:12.000Z" class="text-sm text-body-base"> February 24th, 2015 </time> <div class="flex flex-wrap gap-2"> <span class="px-2 py-1 text-sm rounded-sm bg-primary/10 text-primary border-primary border flex items-center justify-center leading-none font-medium"> Asciidoctor </span> </div> </div> </div>  <div class="mt-8"> <p><a href="/images/wp-content/uploads/2014/08/asciidoctor1.png"><img src="/images/wp-content/uploads/2014/08/asciidoctor1-300x150.png" alt="asciidoctor"></a>My work on creating an <a href="https://github.com/gregturn/asciidoctor-packt">asciidoctor backend for Packt Publishing</a> (i.e. OpenOffice) seems to have caught several people’s attention. Today I spotted an exchange of tweets asking about OpenOffice in general. I figured a more detailed approach to doing that would better fit in a blog posting.</p>
<p><strong>Starting with the basics</strong></p>
<p>For starters, this whole thing is based on creating an FODT document, not an ODT one. The “F” stands for Flat and it is basically an XML document. Your mission, should you choose to accept it, is to create an XML document with all the right parts. That’s the reason my backend is written in <a href="http://slim-lang.com/">SLIM</a>.</p>
<p>SLIM is basically XML with every bit of unnecessary stuff removed. No closing tags. No angled brackets. Nested elements are denoted by indentation, hence giving it a more YAML-like feel. Checkout the <a href="https://github.com/gregturn/asciidoctor-packt/blob/master/slim/packt/section.fodt.slim">following fragment for generating different section levels</a>.</p>
<p><strong>Working backwards</strong></p>
<p>My recommendation is to start from a document you know and love. I started with Packt’s template they sent me. I performed a “Save As” and picked “Flat ODT” to get it into XML format. I then wrote a sample asciidoctor document with all the things I wanted. I suggest you start small and not get into complex layouts (yet). Remember: Minimum Viable Production (MVP) is the key to short, iterative success. From there, I started running my backend against this thing and comparing it with the outcome.</p>
<blockquote>
<p>Got <strong>xmllint</strong>? If not, you should. Your output will be compressed XML. xmllint is the key to viewing your FODT output. Got giant monitor? .It can help dealing with stuff scrolling off the screen as you inspect your handiwork.</p>
</blockquote>
<p>A key thing to understand. Asciidoctor splits up each “element” of asciidoc into a separate fragments and looks for the corresponding stuff in your backend. Got a “section”? Look for <strong>slim/packt/section.fodt.slim.</strong></p>
<ul>
<li><strong>slim</strong> is the template engine</li>
<li><strong>packt</strong> is the name of the backend (hence all your fragments will be there)</li>
<li><strong>section.fodt.slim</strong> is convention-over-configuration for generating an FODT-styled chunk of XML everytime asciidoctor hits a “section”.</li>
</ul>
<p>The top level thing for you document is, duh, <strong>document.fodt.slim</strong>. And this is also where you’ll find the root FODT XML <a href="office:document">office:document</a>.  Way at the <a href="https://github.com/gregturn/asciidoctor-packt/blob/master/slim/packt/document.fodt.slim#L1079">bottom is a common pattern</a>, “=content”. This says, continue processing further asciidoc tokens and insert results at this level.</p>
<p><strong>Iteration is the key to success</strong></p>
<p>To run your backend against your asciidoc input:</p>
<p>asciidoctor -T /path/to/your/backend-root/slim -b packt your.adoc</p>
<p>My backend doesn’t cover every possible element of asciidoc because I didn’t need them. With asciidoctor, you can start with just <strong>document.fodt.slim</strong> &#x26; <a href="https://github.com/gregturn/asciidoctor-packt/blob/master/slim/packt/helpers.rb"><strong>helpers.rb</strong></a> and when it hits an unknown token, it will tell in simple terms. Go and code <strong><foo>.fodt.slim</foo></strong>, and run again. Eventually, you can piece out your entire document. And in the process, you’ll become quite fluent with both FODT and asciidoctor.</p>
<p><strong>Don’t give up!</strong></p>
<p>You will undoubtedly hit some bumps. I sure did. One was getting my code fragments to apply a different style to the last line of any block of code. I probably invested two weeks of effort in this entire backend while writing <a href="https://www.packtpub.com/application-development/learning-spring-boot"><em>Learning Spring Boot</em></a>, but the payoff was enormous. If you are trying to convert a giant slew of documents, try to avoid after the fact edits. And if possible, get the core stuff working, like sections, paragraphs, bold/italics, bullets and admonitions. That stuff really motivated me to push forward.</p>
<p><strong>Oh yeah…</strong></p>
<p>Last time I checked, asciidoctor has special processing rules for double underscrores (__). Several of my style names from Packt had them, and it caused havoc. Once I tracked it down, I simply did a global replace, reducing them to single underscores. DON’T USE DOUBLE UNDERSCORES FOR ANYTHING!</p>
<p>Good luck!</p> </div> </article>  <footer class="bg-black text-white pb-small pt-large"> <div class="site-container mx-auto px-4">  <div class="grid grid-cols-1 md:grid-cols-4 gap-8 pb-8 border-b border-background-light"> <div class="col-span-1"> <a href="/" class="logo uppercase font-logo transition-colors duration-200 font-light text-footer-logo hover:text-primary">  <img src="/_astro/astro.Dm8K3lV8_Z1zWTOa.svg" alt width="115" height="48" loading="lazy" decoding="async" class="hidden"> <span class="font-bold">Greetings</span> Programs!
</a> <p class="mt-4 text-white">
Searching the universe of software development for answers
</p> </div> <div class="col-span-1"> <h3 class="text-lg font-semibold mb-4">Quick Links</h3> <nav> <ul class="space-y-2"> <li><a href="/" class="text-body-dark hover:text-white transition-colors">Home</a></li><li><a href="/bio" class="text-body-dark hover:text-white transition-colors">About Greg</a></li><li><a href="/whitelist-instructions" class="text-body-dark hover:text-white transition-colors">Whitelist Instructions</a></li> </ul> </nav> </div> </div> <div class="mt-8 flex flex-col md:flex-row justify-between items-center"> <div class="text-body-dark text-sm">
© 2025 Greg L. Turnquist. All rights reserved.
</div> <nav class="mt-4 md:mt-0"> <ul class="flex flex-wrap gap-6"> <li> <a href="/legal/privacy-policy" class="text-sm text-body-dark hover:text-white transition-colors"> Privacy Policy </a> </li><li> <a href="/legal/terms-of-service" class="text-sm text-body-dark hover:text-white transition-colors"> Terms of Service </a> </li> </ul> </nav> </div> </div> </footer> <!--<ThemeSwitcher />--> <script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.DLBBgGU8.js"></script> </body> </html>