<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="sitemap" href="/sitemap-index.xml"><link rel="canonical" href="https://www.greglturnquist.com/blog/something-java-should-never-do/"><meta name="generator" content="Astro v5.6.0"><title>Something Java should never do | Greetings, Programs!</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-X8BZNP13K6"></script> <script type="module">
    window.dataLayer = window.dataLayer || [];
    function a() { dataLayer.push(arguments); }
    a("js", new Date());
    a("config", "G-X8BZNP13K6");
</script><meta name="description" content="I've been working on a pull request on Spring HATEOAS for six weeks. That's right, six weeks. It was a community contribution, and there's a"><meta name="robots" content="index, follow"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Bruno+Ace+SC&family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://www.greglturnquist.com/blog/something-java-should-never-do/"><meta property="og:title" content="Something Java should never do | Greetings, Programs!"><meta property="og:description" content="I've been working on a pull request on Spring HATEOAS for six weeks. That's right, six weeks. It was a community contribution, and there's a"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://www.greglturnquist.com/blog/something-java-should-never-do/"><meta property="twitter:title" content="Something Java should never do | Greetings, Programs!"><meta property="twitter:description" content="I've been working on a pull request on Spring HATEOAS for six weeks. That's right, six weeks. It was a community contribution, and there's a"><link rel="stylesheet" href="/_astro/_page_.XwDe0M5r.css">
<link rel="stylesheet" href="/_astro/_page_.DvB2Xm2x.css"></head> <body data-theme="dionysus"> <header class="fixed top-0 z-50 w-full left-0"> <div class="site-container mx-auto px-4 mt-4"> <div class="flex justify-between items-center bg-white py-4 rounded-lg px-4 border-black border"> <a href="/" class="logo uppercase font-logo transition-colors duration-200 font-light text-header-logo hover:text-primary">  <img src="/_astro/astro.Dm8K3lV8_tfbSl.svg" alt width="115" height="48" loading="lazy" decoding="async" class="hidden"> <span class="font-bold">Greetings</span> Programs!
</a> <nav class="relative flex items-center gap-2 lg:gap-8" aria-label="Site Navigation"> <!-- Desktop Menu --> <ul class="hidden lg:flex lg:gap-8 items-center"> <li class="relative group"> <div class="flex items-center gap-1"> <a href="/bio" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text hover:text-nav-text-hover"> About Greg  </a> </div>  </li><li class="relative group"> <div class="flex items-center gap-1"> <a href="/books" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text hover:text-nav-text-hover"> Books  </a> </div>  </li><li class="relative group"> <div class="flex items-center gap-1"> <a href="/blog" class="text-small font-medium rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-nav-text-active text-nav-text-current font-semibold" aria-current="page"> Blog  </a> </div>  </li> </ul> <a href="/list" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 bg-primary text-white hover:bg-primary-light focus-visible:ring-primary hover:ring-2 hover:ring-primary hover:ring-offset-2 h-10 px-4 py-2 text-small " aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Sign Up </a> <!-- Mobile Menu Button --> <button class="mobile-menu-button relative z-30 p-2 border-none cursor-pointer bg-transparent lg:hidden" aria-label="Toggle Menu" aria-expanded="false"> <span class="menu-icon block"> <svg xmlns="http://www.w3.org/2000/svg" stroke-width="2" width="24" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none" viewBox="0 0 24 24" class="lucide lucide-menu text-body-base">  <line x1="4" x2="20" y1="12" y2="12"></line> <line x1="4" x2="20" y1="6" y2="6"></line> <line x1="4" x2="20" y1="18" y2="18"></line>  </svg> </span> <span class="close-icon hidden"> <svg xmlns="http://www.w3.org/2000/svg" stroke-width="2" width="24" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none" viewBox="0 0 24 24" class="lucide lucide-x text-white">  <path d="M18 6 6 18"></path> <path d="m6 6 12 12"></path>  </svg> </span> </button> <!-- Mobile Menu Panel --> <div class="mobile-menu fixed inset-0 z-20 px-8 pt-20 bg-primary lg:hidden hidden opacity-0 scale-95 transform transition-all duration-200 ease-out overflow-y-auto"> <ul class="flex flex-col gap-4"> <li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/bio" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text hover:text-nav-mobile-text-hover"> About Greg </a>  </div>  </div> </li><li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/books" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text hover:text-nav-mobile-text-hover"> Books </a>  </div>  </div> </li><li> <div class="text-white"> <div class="flex items-center justify-between"> <a href="/blog" class="py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-nav-mobile-text-active text-nav-mobile-text-current font-semibold" aria-current="page"> Blog </a>  </div>  </div> </li> </ul> <!-- Updated mobile CTA button styling --> <div class="mt-8 pb-8"> <a href="/list" class="group relative inline-flex overflow-hidden items-center justify-center rounded-border-small font-medium transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 rounded-md flex items-center gap-2 text-white ring-2 ring-white focus-visible:ring-white hover:ring-2 hover:ring-black hover:ring-offset-2 h-10 px-4 py-2 text-small " aria-disabled="false"> <span class="absolute left-0 -mt-12 h-32 w-1/2 translate-x-[250%] rotate-12 bg-white opacity-20 transition-all duration-250 ease-out group-hover:translate-x-[2%]"></span> Sign Up </a> </div> </div> </nav> </div> </div></header> <script type="module">const v=document.querySelectorAll(".group");v.forEach(s=>{const e=s.querySelector("a"),t=s.querySelector(".submenu"),n=t?.querySelectorAll("a");t&&e&&(s.addEventListener("mouseenter",()=>{l(t,e)}),s.addEventListener("mouseleave",()=>{i(t,e)}),e.addEventListener("keydown",c=>{c.key==="ArrowDown"&&s.children&&(c.preventDefault(),l(t,e),n?.[0]?.focus())}),e.addEventListener("focus",()=>{i(t,e)}),n?.forEach((c,a)=>{c.addEventListener("keydown",d=>{const m=n.length-1;switch(d.key){case"ArrowDown":d.preventDefault(),a<m&&n[a+1].focus();break;case"ArrowUp":d.preventDefault(),a>0?n[a-1].focus():(e.focus(),i(t,e));break;case"Escape":d.preventDefault(),i(t,e),e.focus();break;case"Tab":i(t,e);break}})}),document.addEventListener("focusin",c=>{s&&!s.contains(c.target)&&i(t,e)}))});function l(s,e){s.classList.remove("invisible","opacity-0"),s.classList.add("visible","opacity-100"),e.setAttribute("aria-expanded","true")}function i(s,e){s.classList.add("invisible","opacity-0"),s.classList.remove("visible","opacity-100"),e.setAttribute("aria-expanded","false")}document.querySelectorAll(".mobile-submenu-button").forEach(s=>{s.addEventListener("click",()=>{const e=s.parentElement?.nextElementSibling,t=s.querySelector("svg");if(e){e.classList.toggle("hidden"),t?.classList.toggle("rotate-180");const n=e.classList.contains("hidden")?"false":"true";s.setAttribute("aria-expanded",n)}})});const f=document.querySelector(".mobile-menu-button"),o=document.querySelector(".mobile-menu"),r=document.querySelector(".menu-icon"),u=document.querySelector(".close-icon");f?.addEventListener("click",()=>{o?.classList.contains("hidden")?(document.body.style.overflow="hidden",o?.classList.remove("hidden"),requestAnimationFrame(()=>{o?.classList.remove("opacity-0","scale-95"),o?.classList.add("opacity-100","scale-100")}),r?.classList.add("hidden"),u?.classList.remove("hidden")):(document.body.style.overflow="",o?.classList.add("opacity-0","scale-95"),o?.classList.remove("opacity-100","scale-100"),setTimeout(()=>{o?.classList.add("hidden")},200),r?.classList.remove("hidden"),u?.classList.add("hidden"))});</script>  <div class="w-full h-120 absolute top-0 left-0 z-0 overflow-hidden border-b border-black">  </div> <article class="site-container--small mx-auto px-4 prose relative z-10 pb-base"> <div class="mt-42 mb-12 text-center"> <h1>Something Java should never do</h1> <div class="flex items-center justify-center gap-4 text-gray-600"> <time datetime="2017-05-20T07:18:59.000Z" class="text-sm text-body-base"> May 20th, 2017 </time> <div class="flex flex-wrap gap-2"> <span class="px-2 py-1 text-sm rounded-sm bg-primary/10 text-primary border-primary border flex items-center justify-center leading-none font-medium"> Maven </span><span class="px-2 py-1 text-sm rounded-sm bg-primary/10 text-primary border-primary border flex items-center justify-center leading-none font-medium"> Java </span> </div> </div> </div>  <div class="mt-8"> <p>I’ve been working on a pull request on Spring HATEOAS for six weeks. That’s right, six weeks. It was a community contribution, and there’s a lot to sift through. Yesterday morning, I was slated to conduct the first review with the project lead. But that wasn’t going to happen, because Java decided to do something Java should never do.</p>
<p>Maven **wouldn’**t build my project while IntelliJ IDEA <strong>would</strong>.</p>
<p><img src="/images/wp-content/uploads/2017/05/dog-tilted-head.jpeg" alt="">I was alerted to this issue Thursday morning when I created a “run all profiles” script and it wouldn’t work. Huh? Every time I’ve pushed an updated commit to Travis CI, it builds perfectly. That’s right, a CI server, running Maven, built my branch with ease. But my Mac would not.</p>
<p>This made no sense. <em>This is something Java should never do</em>! Java doesn’t work on Linux but fail on a Mac. It must be my machine, right? So I log onto my wife’s MacBook Air, update Java to the latest version, grab the source, and fire off Maven. BOOM! It breaks just the same.</p>
<p>So…here comes the online review with Ollie. I pronounce my inability to build the system. The man with twenty years professional experience, who has <a href="/learning-spring-boot">written four tech books</a> and one tech video, who has been fighting this for twenty four hours, pleads with his manager for clues. Ollie grabs the branch, tries to build, and SPLAT. It doesn’t work. He goes through the same questions I do, and finds no answers.</p>
<p>We jump to our OTHER CI server, Bamboo, and he commands it to build my branch. It works. Perfectly.</p>
<blockquote>
<p>Score so far: Three Macs - <strong>0</strong>  Two Linux CI servers - <strong>2</strong></p>
</blockquote>
<p><img src="/images/wp-content/uploads/2016/11/megaphone-150x150.png" alt="">“Ollie, this is something Java should never do!” I scream into my Google Hangout. (Okay, maybe I didn’t scream.)</p>
<p>He nods along. The review is busted. We both flip to our daily standup Hangout, and Ollie’s first words are, “Greg, I know what you did.” Heh.</p>
<p>We wrap that meeting up, and I proceed to dig through every Stackoverflow article I can find on Lombok, maven-compiler-plugin, and Java 6. Talk about a nebulous combination. WIth enough evidence that this is Lombok’s fault, I open a <a href="https://github.com/rzwitserloot/lombok/issues/1396">ticket</a>.</p>
<p>Fun day, given it’s my son’s last day of school for the year. I’m irritated at having to stop work to fetch him. My brain keeps churning the whole time. The second I get home, I have him go play. Anything to get back to my keyboard and keep trying options. I flip through a myriad of options for maven-compiler-plugin: memory, forked JDK, use Java 8, hand configure annotation processors. Nothing works.</p>
<p><img src="/images/wp-content/uploads/2015/03/laptop_chimp-150x150.jpg" alt="">My three-year-old is trying to climb up on me, and I push him to the side. “I must find the answer!” Time to pick up our 7-year-old arrives, and I dash off. After getting home, she is asking me to write LOGO code. “No sweetheart, I need to try something first.” I usually stop ANYTHING to help her, but I was too obsessed with this issue.</p>
<p>At this point, I start to De-lombok the code. Maybe if I can flip Lombok off. I get 90% of the code converted, and IT STILL WON’T BUILD! What could this possibly be? Every debug/verbose flag I activate still shows me nothing about what is actually breaking. Just some missing symbols followed a completely corrupted class.</p>
<p>Then I get a strange idea. A curious insight. What if the first class that Maven claims about, a nested static class, was made top level? I command IntelliJ to perform this refactoring. Poof, the error message changes. So I make the next nested static class in the list of errors top level as well.</p>
<blockquote>
<p>BANG! Reading “[INFO] BUILD SUCCESS” makes my jaw drop.</p>
</blockquote>
<p>I cancel all my changes, and build again. Same failure. I then strategically pick one nest static class, and move it. Everything suddenly works. What the…? This is something Java should never do.</p>
<p>Looking at the <strong>Jackson2HalModule</strong> (the predecessor to my work on <strong>Jackson2HalFormsModule</strong>), I count the number of nested static classes and compare to this one. The HAL parser has eight or nine, the new work has over twelve. Somehow, this enclosing class has TOO MANY NESTED STATIC CLASSES!</p>
<p><img src="/images/wp-content/uploads/2011/10/Kaypro_in_Israel_1984-203x300.jpg" alt="">Not wanting to move everything into public classes, I rig up <strong>HalFormsSerializers</strong> and <strong>HalFormsDeserializers</strong>, and split up the nested static classes into these two “namespaces”. Everything is humming. This change is mind boggling. Because this is something Java should never do.</p>
<p>So what is happening? Still not sure, but it implies that Lombok’s annotation processor must scan every class looking for its annotations. If the class is too deep, the scanner breaks and doesn’t recover, hence causing any nested classes further on to fail. And somehow, this state is contingent on the platform, because it works jim dandy on Linux while failing on the Mac.</p>
<p>I copy all these details into the Lombok ticket I opened. I hope I shined a light on an issue perhaps the committers can pinpoint and fix. But for now, my PR is buffed up and reviewable again. And as I go to bed, I can finally sleep in peace, having slain another dragon in the realm of open source hacking.</p>
<p><img src="/images/wp-content/uploads/2016/05/boring-meeting-300x200.jpg" alt=""></p> </div> </article>  <footer class="bg-black text-white pb-small "> <div class="site-container mx-auto px-4"> <!--{!cta.hideCta && (--> <!--  <div class="text-center border-b border-background-light mb-12 py-small">--> <!--    <h2 class="text-3xl font-bold mb-4" data-aos="fade-up">{cta.title}</h2>--> <!--    <p class="text-white mb-6 max-w-2xl mx-auto" data-aos="fade-up" data-aos-delay="100">--> <!--      {cta.description}--> <!--    </p>--> <!--    <Button--> <!--      href={cta.button.link}--> <!--      variant="ghostLight"--> <!--      size="lg"--> <!--      data-aos="fade-up"--> <!--      data-aos-delay="200"--> <!--      {...(cta.button.target && { target: cta.button.target })}--> <!--    >--> <!--      {cta.button.text}--> <!--    </Button>--> <!--  </div>--> <!--)}--> <div class="grid grid-cols-1 md:grid-cols-4 gap-8 pb-8 border-b border-background-light"> <div class="col-span-1"> <a href="/" class="logo uppercase font-logo transition-colors duration-200 font-light text-footer-logo hover:text-primary">  <img src="/_astro/astro.Dm8K3lV8_tfbSl.svg" alt width="115" height="48" loading="lazy" decoding="async" class="hidden"> <span class="font-bold">Greetings</span> Programs!
</a> <p class="mt-4 text-white">
Searching the universe of software development for answers
</p> </div> <div class="col-span-1"> <h3 class="text-lg font-semibold mb-4">Quick Links</h3> <nav> <ul class="space-y-2"> <li><a href="/" class="text-body-dark hover:text-white transition-colors">Home</a></li><li><a href="/bio" class="text-body-dark hover:text-white transition-colors">About Greg</a></li><li><a href="/whitelist-instructions" class="text-body-dark hover:text-white transition-colors">Whitelist Instructions</a></li> </ul> </nav> </div> </div> <div class="mt-8 flex flex-col md:flex-row justify-between items-center"> <div class="text-body-dark text-sm">
© 2025 Greg L. Turnquist. All rights reserved.
</div> <nav class="mt-4 md:mt-0"> <ul class="flex flex-wrap gap-6"> <li> <a href="/legal/privacy-policy" class="text-sm text-body-dark hover:text-white transition-colors"> Privacy Policy </a> </li><li> <a href="/legal/terms-of-service" class="text-sm text-body-dark hover:text-white transition-colors"> Terms of Service </a> </li> </ul> </nav> </div> </div> </footer> <!--<ThemeSwitcher />--> <script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.Cqrgs33o.js"></script> </body> </html>